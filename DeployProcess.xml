<?xml version="1.0" encoding="UTF-8"?>
<wps:DeployProcess service="WPS" version="2.0.0" xmlns:wps="http://www.opengis.net/wps/2.0" xmlns:ows="http://www.opengis.net/ows/2.0" xmlns:owc="http://www.opengis.net/owc/1.0" xmlns:eoc="http://www.opengis.net/wps/2.0/profile/tb13/eoc" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<wps:ProcessOffering xmlns:wps="http://www.opengis.net/wps/2.0" xmlns:ows="http://www.opengis.net/ows/2.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:atom="http://www.w3.org/2005/Atom" jobControlOptions="async-execute dismiss" outputTransmission="value reference">
		<wps:Process>
			<ows:Title>MultiSensor NDVI</ows:Title>
			<ows:Identifier>multisensor_ndvi</ows:Identifier>
			<!--  INPUT IMAGES  -->
			<wps:Input minOccurs="0" maxOccurs="unbounded">
				<ows:Title>Input Image</ows:Title>
				<ows:Identifier>inputImage</ows:Identifier>
				<!-- The following block includes all CWL properties -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/cwl">
					<ows:AdditionalParameter>
						<ows:Name>position</ows:Name>
						<ows:Value>1</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>prefix</ows:Name>
						<ows:Value>inImageFolder</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>separate</ows:Name>
						<ows:Value>false</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>itemSeparator</ows:Name>
						<ows:Value>=</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>cwlName</ows:Name>
						<ows:Value>inImageFolder</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<!-- The following block holds indication about the catalog search  -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/catalog">
					<ows:AdditionalParameter>
						<ows:Name>searchable</ows:Name>
						<ows:Value>true</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<!-- As in Testbed13, the use case is that the catalog URL is provided in OWS Context (alternatively, we could simply add a new AdditionalParamaters -->
				<!-- The advantage of OWS Context is that it may include (in a standard way) additional request parameters etc. -->
				<eoc:ApplicationContext>
					<owc:offering code="http://www.opengis.net/spec/owc-atom/1.0/req/opensearch">
						<owc:content type="application/opensearchdescription+xml" href="http://geo.spacebel.be/opensearch/description.xml?parentIdentifier=EOP%3AIPT%3ASentinel2"/>
					</owc:offering>
					<!-- OpenSearch offering for AWS -->
					<owc:offering code="http://www.opengis.net/spec/owc-atom/1.0/req/opensearch">
						<owc:content type="application/opensearchdescription+xml" href="http://geo.spacebel.be/opensearch/description.xml?parentIdentifier=EOP%3ASENTINEL-HUB%3ASentinel2"/>
					</owc:offering>
				</eoc:ApplicationContext>
				<wps:ComplexData>
					<wps:Format mimeType="text/directory" default="true"/>
				</wps:ComplexData>
			</wps:Input>
			<!--  CATALOGUE SEARCH PARAMETERS (may also be consumed by processing chain !)  -->
			<!--  START DATE  -->
			<wps:Input>
				<ows:Title>Start Date</ows:Title>
				<ows:Identifier>startDate</ows:Identifier>
				<!-- The following block includes all CWL properties -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/cwl">
					<ows:AdditionalParameter>
						<ows:Name>position</ows:Name>
						<ows:Value>1</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>prefix</ows:Name>
						<ows:Value>startDate</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>separate</ows:Name>
						<ows:Value>false</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>itemSeparator</ows:Name>
						<ows:Value>=</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<!-- The following block holds indication about the catalog search  -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/catalog">
					<ows:AdditionalParameter>
						<!-- Indicate the matching field to use for the catalog search (because may be different from the WPS input identifier! )  -->
						<ows:Name>catalogSearchInputField</ows:Name>
						<ows:Value>startDate</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<wps:LiteralData>
					<wps:Format mimeType="text/plain" default="true"/>
					<LiteralDataDomain default="true">
						<ows:AnyValue/>
						<ows:DataType ows:reference="http://www.w3.org/2001/XMLSchema#dateTime">dateTime</ows:DataType>
					</LiteralDataDomain>
				</wps:LiteralData>
			</wps:Input>
			<!--  END DATE  -->
			<wps:Input>
				<ows:Title>End Date</ows:Title>
				<ows:Identifier>endDate</ows:Identifier>
				<!-- The following block includes all CWL properties -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/cwl">
					<ows:AdditionalParameter>
						<ows:Name>position</ows:Name>
						<ows:Value>2</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>prefix</ows:Name>
						<ows:Value>endDate</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>separate</ows:Name>
						<ows:Value>false</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>itemSeparator</ows:Name>
						<ows:Value>=</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
								<!-- The following block holds indication about the catalog search  -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/catalog">
					<ows:AdditionalParameter>
						<!-- Indicate the matching field to use for the catalog search (because may be different from the WPS input identifier! )  -->
						<ows:Name>catalogSearchInputField</ows:Name>
						<ows:Value>endDate</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<wps:LiteralData>
					<wps:Format mimeType="text/plain" default="true"/>
					<LiteralDataDomain default="true">
						<ows:AnyValue/>
						<ows:DataType ows:reference="http://www.w3.org/2001/XMLSchema#dateTime">dateTime</ows:DataType>
					</LiteralDataDomain>
				</wps:LiteralData>
			</wps:Input>
			<!--  AREA OF INTEREST  -->
			<wps:Input>
				<ows:Title>Area Of Interest</ows:Title>
				<ows:Identifier>aoi</ows:Identifier>
				<!-- The following block includes all CWL properties -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/cwl">
					<ows:AdditionalParameter>
						<ows:Name>position</ows:Name>
						<ows:Value>3</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>prefix</ows:Name>
						<ows:Value>aoi</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>separate</ows:Name>
						<ows:Value>false</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>itemSeparator</ows:Name>
						<ows:Value>=</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
								<!-- The following block holds indication about the catalog search  -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/catalog">
					<ows:AdditionalParameter>
						<!-- Indicate the matching field to use for the catalog search (because may be different from the WPS input identifier! )  -->
						<ows:Name>catalogSearchInputField</ows:Name>
						<ows:Value>aoi</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<wps:LiteralData>
					<wps:Format mimeType="application/wkt" default="true"/>
					<LiteralDataDomain default="true">
						<ows:AnyValue/>
						<ows:DataType ows:reference="http://www.w3.org/2001/XMLSchema#string">string</ows:DataType>
					</LiteralDataDomain>
				</wps:LiteralData>
			</wps:Input>
			<!--  COORDINATE REFERENCE SYSTEM OR AOI -->
			<wps:Input>
				<ows:Title>Coordinate Reference System of AOI</ows:Title>
				<ows:Identifier>aoiCrs</ows:Identifier>
				<!-- The following block includes all CWL properties -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/cwl">
					<ows:AdditionalParameter>
						<ows:Name>position</ows:Name>
						<ows:Value>4</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>prefix</ows:Name>
						<ows:Value>aoiCrs</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>separate</ows:Name>
						<ows:Value>false</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>itemSeparator</ows:Name>
						<ows:Value>=</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
								<!-- The following block holds indication about the catalog search  -->
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/eoc/applicationContext/catalog">
					<ows:AdditionalParameter>
						<!-- Indicate the matching field to use for the catalog search (because may be different from the WPS input identifier! )  -->
						<ows:Name>catalogSearchInputField</ows:Name>
						<ows:Value>crs</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<wps:LiteralData>
					<wps:Format mimeType="text/plain" default="true"/>
					<LiteralDataDomain default="true">
						<ows:AnyValue/>
						<ows:DataType ows:reference="http://www.w3.org/2001/XMLSchema#anyURI">anyURI</ows:DataType>
					</LiteralDataDomain>
				</wps:LiteralData>
			</wps:Input>
			<wps:Input>
				<ows:Title>Output Images Folder</ows:Title>
				<ows:Identifier>outputImagesFolder</ows:Identifier>
				<ows:AdditionalParameters about=".../inputBinding">
					<ows:AdditionalParameter>
						<ows:Name>position</ows:Name>
						<ows:Value>6</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>prefix</ows:Name>
						<ows:Value>outputImagesFolder</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>separate</ows:Name>
						<ows:Value>false</ows:Value>
					</ows:AdditionalParameter>
					<ows:AdditionalParameter>
						<ows:Name>itemSeparator</ows:Name>
						<ows:Value>=</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
				<wps:LiteralData>
					<wps:Format mimeType="text/plain" default="true"/>
					<LiteralDataDomain default="true">
						<ows:AnyValue/>
						<ows:DataType ows:reference="http://www.w3.org/2001/XMLSchema#string">string</ows:DataType>
					</LiteralDataDomain>
				</wps:LiteralData>
			</wps:Input>
			<!--  NDVI OUTPUT FILE(S)  -->
			<wps:Output>
				<ows:Title>GeoTIF Image</ows:Title>
				<ows:Abstract>Labeled GeoTIF file containing, for each pixel, one of the class codes specified in the training reference data.</ows:Abstract>
				<ows:Identifier>output</ows:Identifier>
				<wps:ComplexData>
					<wps:Format mimeType="image/tiff" default="true"/>
				</wps:ComplexData>
				<ows:AdditionalParameters xlink:role="http://www.opengis.net/profiles/eoc/output">
					<!-- Path provides the path of the output-->
					<ows:AdditionalParameter>
						<ows:Name>path</ows:Name>
						<ows:Value>output/image.tiff</ows:Value>
					</ows:AdditionalParameter>
				</ows:AdditionalParameters>
			</wps:Output>
		</wps:Process>
	</wps:ProcessOffering>
	<wps:DeploymentProfile>
	<!-- The deployment profile is a WPS-T property to define the application package format (in this case the dockerized application for EOC)-->
		<wps:DeploymentProfileName>http://www.opengis.net/profiles/eoc/dockerizedApplicationxsd</wps:DeploymentProfileName>
		<wps:ExecutionUnit>
		<!-- In our case, the Execution Unit is not a BPEL, a Java, but is the Docker Image reference -->
			<wps:Reference href="registry.hub.docker.com/testbed14/multisensor_ndvi"/>
		</wps:ExecutionUnit>
	</wps:DeploymentProfile>
</wps:DeployProcess>
